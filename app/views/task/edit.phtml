
<!-- new -->
<h2 class="headform textCenter">Edit Task</h2>
<?php
   echo $this->tag->form(
       [
         
           "autocomplete" => "off",
           "class" => "form-horizontal",
          
       ]
   );
   ?>
            <?php 
            echo $this->tag->hiddenField(["idProject", "id" => "EdidProject" ]);
            echo $this->tag->hiddenField(["idTask", "id" => "EdidTask" ]);
            ?>
<div class="ui raised segment very padded">
   <div class="ui large form">
      <div class="field">
         <label>Task</label>
         <?php 
            echo $this->tag->textField(["taskname", "size" => 30, 
            "class" => "form-control", "id" => "Edname" , "placeholder"=>"task name"]) 
            ?>
      </div>
      <div class="field">
         <label>IsA</label>
         <?php 
            echo $this->tag->textField(["isA", "size" => 30, 
            "class" => "form-control", "id" => "EdisA" , "placeholder"=>"isA"]) 
            ?>
      </div>
      <div class="field">
         <label>Description</label>
         <?php 
            echo $this->tag->textArea(["Description", "class" => "form-control", 
            "id" => "EdDescription" , "placeholder"=>"Description","rows" => 3,]) 
            ?>
      </div>
      <div class="field">
         <label>Includes</label>
         <?php 
            echo $this->tag->textField(["includes", "size" => 30, 
            "class" => "form-control", "id" => "Edincludes" , "placeholder"=>"includes"]) 
            ?>
      </div>
      <div class="field">
         <label>asIsState</label>
         <?php 
            echo $this->tag->selectStatic(["asIsState", "class" => "form-control", 
            "id" => "EdasIsState" 
            ,[
                "E" => "EXIST",
                "N" => "NEXIST",
            ]
            ]) 
            ?>
      </div>
      <div class="field">
         <label>Owner</label>
         <?php 
            echo $this->tag->textField(["owner", "size" => 30, 
            "class" => "form-control", "id" => "Edowner" ]) 
            ?>
      </div>
      <div class="field">
         <label>Collaburator</label>
         <?php 
            echo $this->tag->textField(["collaburator", "size" => 30, 
            "class" => "form-control", "id" => "Edcollaburator" ]) 
            ?>      
      </div>
      <div class="field">
         <label>Regulator</label>
         <?php 
            echo $this->tag->textField(["regulator", "size" => 30, 
            "class" => "form-control", "id" => "Edregulator"]) 
            ?>
      </div>
      <div class="field">
         <label>Uses</label>
         <?php 
            echo $this->tag->textField(["uses", "size" => 30, 
            "class" => "form-control", "id" => "Eduses" , "placeholder"=>"uses"]) 
            ?>
      </div>
      <div class="field">
         <label>Produces</label>
         <?php 
            echo $this->tag->textField(["produces", "size" => 30, 
            "class" => "form-control", "id" => "Edproduces" , "placeholder"=>"produces"]) 
            ?>
      </div>
      <div class="field">
         <label>toBeState</label>
         <?php 
            echo $this->tag->selectStatic(["toBeState", "class" => "form-control", 
            "id" => "EdtoBeState" 
            ,[
                "E" => "EXIST",
                "N" => "NEXIST",
                "A" => "ADEPTED",
            ]
            ]) 
            ?>
      </div>
      <div class="field">
         <label>ownerToBe</label>
         <?php 
            echo $this->tag->textField(["ownerToBe", "size" => 30, 
            "class" => "form-control", "id" => "EdownerToBe"]) 
            ?>
      </div>
      <div class="field">
         <label>collaboratorToBe</label>
         <?php 
            echo $this->tag->textField(["collaboratorToBe", "size" => 30, 
            "class" => "form-control", "id" => "EdcollaboratorToBe" ]) 
            ?>
      </div>
      <div class="field">
         <label>toUse</label>
         <?php 
            echo $this->tag->textField(["toUse", "size" => 30, 
            "class" => "form-control", "id" => "EdtoUse"]) 
            ?>
         
      </div>
      <div class="field">
         <label>toProduce</label>
         <?php 
            echo $this->tag->textField(["toProduce", "size" => 30, 
            "class" => "form-control", "id" => "EdtoProduce" , "placeholder"=>"toProduce"]) 
            ?>
      </div>

      <?php echo $this->tag->endForm(); ?>
      <?php 
         echo $this->tag->submitButton(["saveTask", "size" => 30, 
         "class" => "btn btn-primary", "id" => "editTask"]) 
         ?>
   </div>
</div>

<script>
                  
  var js_test = '<?php echo json_encode($test); ?>';
  js_test = JSON.parse(js_test);
  js_test = createJSON(js_test);
  js_test = JSON.stringify(js_test);
 
 
  var data_owner = '<?php echo json_encode($owner); ?>';
 
  var data_collaburator = '<?php echo json_encode($collaburator); ?>';
  
  var data_ownerTobe = '<?php echo json_encode($ownerTobe); ?>';
  var data_collaboratorTobe = '<?php echo json_encode($collaboratorTobe); ?>';
  
  

  $(document).ready(function(){

    var Stakeholder = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace('text'),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: JSON.parse(js_test)
    });

    Stakeholder.initialize();

    var EdownerToBe = $('#EdownerToBe');
    EdownerToBe.tagsinput({
      itemValue: 'value',
      itemText: 'text',
      typeaheadjs: {
        name: 'name',
        displayKey: 'text',
        source: Stakeholder.ttAdapter(),
        templates: {
          empty: '<div class="empty-message text-info"> No matches.</div>'
        },
      }
    });
    add(EdownerToBe, data_ownerTobe);


    var Edowner = $('#Edowner');
    Edowner.tagsinput({
      itemValue: 'value',
      itemText: 'text',
      typeaheadjs: {
        name: 'name',
        displayKey: 'text',
        source: Stakeholder.ttAdapter(),
        templates: {
          empty: '<div class="empty-message text-info"> No matches.</div>'
        },
      }
    });
    add(Edowner, data_owner);


    var Edcollaburator = $('#Edcollaburator');
    Edcollaburator.tagsinput({
      itemValue: 'value',
      itemText: 'text',
      typeaheadjs: {
        name: 'name',
        displayKey: 'text',
        source: Stakeholder.ttAdapter(),
        templates: {
          empty: '<div class="empty-message text-info"> No matches.</div>'
        },
      }
    });
    add(Edcollaburator, data_collaburator);
   

    var EdcollaboratorToBe = $('#EdcollaboratorToBe');
    EdcollaboratorToBe.tagsinput({
      itemValue: 'value',
      itemText: 'text',
      typeaheadjs: {
        name: 'name',
        displayKey: 'text',
        source: Stakeholder.ttAdapter(),
        templates: {
          empty: '<div class="empty-message text-info"> No matches.</div>'
        },
      }
    });
    add(EdcollaboratorToBe, data_collaboratorTobe);

});


  function add($elt, data){
      $.each(JSON.parse(data), function(index ,data){   
        $elt.tagsinput('add', { "value": data.value, "text": data.name, "continent": "" ,"index": data._id.$id});
      });
  }

  function createOwner($elt){
    $elt.tagsinput('add', { "value": 5555, "text": "new owner", "continent": "" });
  }

  function createJSON(data) {
        jsonObj = [];
        var i = 2;
        $.each(data, function(index ,data){

            item = {};
            item ["value"] = data.value;
            item ["text"] = data.name;
            item ["continent"] = "";
            item ["index"] = data._id.$id;
            i++;
            jsonObj.push(item);
        });

        item = {};
        item ["value"] = 0;
        item ["text"] = "?";
        item ["continent"] = "";
        jsonObj.push(item);
       
        return jsonObj;
  }
</script>